{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "iiitMailId": {
          "type": "string",
          "description": "The user's IIIT email address.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "The user's phone number."
        },
        "uniqueCode": {
          "type": "string",
          "description": "A unique 5-digit code assigned to the user upon account creation."
        }
      },
      "required": [
        "id",
        "name",
        "iiitMailId",
        "phoneNumber",
        "uniqueCode"
      ]
    },
    "Caterer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Caterer",
      "type": "object",
      "description": "Represents a caterer in the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Caterer entity."
        },
        "username": {
          "type": "string",
          "description": "The caterer's username (e.g., 'admin')."
        },
        "isCanteenOpen": {
          "type": "boolean",
          "description": "Indicates whether the canteen is open for orders."
        }
      },
      "required": [
        "id",
        "username",
        "isCanteenOpen"
      ]
    },
    "Order": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Order",
      "type": "object",
      "description": "Represents an order made by a user to a caterer.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Order entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Order)"
        },
        "catererId": {
          "type": "string",
          "description": "Reference to Caterer. (Relationship: Caterer 1:N Order)"
        },
        "items": {
            "type": "array",
            "description": "An array of items included in the order.",
            "items": {
                "type": "object",
                "properties": {
                    "id": {"type": "string"},
                    "name": {"type": "string"},
                    "quantity": {"type": "number"},
                    "price": {"type": "number"},
                    "packaging": {"type": "boolean"},
                    "rated": { "type": "boolean", "description": "Whether the user has rated this item for this order." }
                },
                "required": ["id", "name", "quantity", "price", "packaging"]
            }
        },
        "totalAmount": {
            "type": "number",
            "description": "The total cost of the order."
        },
        "packagingFee": {
            "type": "number",
            "description": "The total packaging fee for the order."
        },
        "status": {
            "type": "string",
            "description": "The current status of the order.",
            "enum": ["Pending", "Processing", "Delivered", "Cancelled"]
        },
        "orderDate": {
          "type": "string",
          "description": "The date the order was placed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "catererId",
        "items",
        "totalAmount",
        "status",
        "orderDate"
      ]
    },
    "MenuItem": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "MenuItem",
      "type": "object",
      "description": "Represents a menu item offered by a caterer.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the MenuItem entity."
        },
        "catererId": {
          "type": "string",
          "description": "The ID of the caterer who owns this menu item."
        },
        "name": {
          "type": "string",
          "description": "The name of the menu item."
        },
        "description": {
          "type": "string",
          "description": "A description of the menu item."
        },
        "price": {
          "type": "number",
          "description": "The price of the menu item."
        },
        "available": {
          "type": "boolean",
          "description": "Whether the menu item is currently available."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL or data URI of the menu item's image."
        },
        "category": {
          "type": "string",
          "description": "The category of the menu item (e.g. 'breakfast', 'lunch')."
        },
        "foodType": {
          "type": "string",
          "description": "The type of food, either 'veg' or 'non-veg'.",
          "enum": ["veg", "non-veg"]
        },
        "averageRating": {
            "type": "number",
            "description": "The average rating of the menu item."
        },
        "numberOfRatings": {
            "type": "number",
            "description": "The total number of ratings for the menu item."
        }
      },
      "required": [
        "id",
        "catererId",
        "name",
        "description",
        "price",
        "available",
        "category",
        "foodType"
      ]
    },
    "Category": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Category",
      "type": "object",
      "description": "Represents a menu category created by a caterer.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Category entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the category (e.g., 'Breakfast', 'Specialty Pizzas')."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "Rating": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Rating",
        "type": "object",
        "description": "Represents a user's rating and review for a menu item.",
        "properties": {
            "id": { "type": "string", "description": "Unique identifier for the Rating entity." },
            "userId": { "type": "string", "description": "The ID of the user who submitted the rating." },
            "menuItemId": { "type": "string", "description": "The ID of the menu item being rated." },
            "orderId": { "type": "string", "description": "The ID of the order associated with this rating." },
            "rating": { "type": "number", "minimum": 1, "maximum": 5, "description": "The rating given by the user, from 1 to 5." },
            "review": { "type": "string", "description": "An optional text review from the user." },
            "createdAt": { "type": "string", "format": "date-time", "description": "The timestamp when the rating was submitted." }
        },
        "required": ["id", "userId", "menuItemId", "orderId", "rating", "createdAt"]
    }
  },
  "auth": {
    "providers": []
  },
  "firestore": {
    "structure": [
      {
        "path": "users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information, including name, IIIT mail ID, phone number, and unique code.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "caterers/{catererId}",
        "definition": {
          "entityName": "Caterer",
          "schema": {
            "$ref": "#/backend/entities/Caterer"
          },
          "description": "Stores caterer profile information, including username.",
          "params": [
            {
              "name": "catererId",
              "description": "The unique identifier for the caterer."
            }
          ]
        }
      },
      {
        "path": "caterers/{catererId}/menuItems/{menuItemId}",
        "definition": {
          "entityName": "MenuItem",
          "schema": {
            "$ref": "#/backend/entities/MenuItem"
          },
          "description": "Stores menu items for a specific caterer.",
          "params": [
            {
              "name": "catererId",
              "description": "The unique identifier for the caterer."
            },
            {
              "name": "menuItemId",
              "description": "The unique identifier for the menu item."
            }
          ]
        }
      },
      {
        "path": "caterers/{catererId}/menuItems/{menuItemId}/ratings/{ratingId}",
        "definition": {
            "entityName": "Rating",
            "schema": { "$ref": "#/backend/entities/Rating" },
            "description": "Stores ratings for a specific menu item.",
            "params": [
                { "name": "catererId", "description": "The ID of the caterer." },
                { "name": "menuItemId", "description": "The ID of the menu item." },
                { "name": "ratingId", "description": "The ID of the rating." }
            ]
        }
      },
      {
        "path": "users/{userId}/orders/{orderId}",
        "definition": {
          "entityName": "Order",
          "schema": {
            "$ref": "#/backend/entities/Order"
          },
          "description": "Stores order information associated with a specific user. Includes the userId and catererId, promoting Authorization Independence.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user who placed the order."
            },
            {
              "name": "orderId",
              "description": "The unique identifier for the order."
            }
          ]
        }
      },
      {
        "path": "caterers/{catererId}/orders/{orderId}",
        "definition": {
          "entityName": "Order",
          "schema": {
            "$ref": "#/backend/entities/Order"
          },
          "description": "Stores order information associated with a specific caterer. Includes the userId and catererId, promoting Authorization Independence.",
          "params": [
            {
              "name": "catererId",
              "description": "The unique identifier for the caterer to whom the order was placed."
            },
            {
              "name": "orderId",
              "description": "The unique identifier for the order."
            }
          ]
        }
      },
      {
        "path": "caterers/{catererId}/categories/{categoryId}",
        "definition": {
          "entityName": "Category",
          "schema": {
            "$ref": "#/backend/entities/Category"
          },
          "description": "Stores the custom menu categories created by a specific caterer.",
          "params": [
            {
              "name": "catererId",
              "description": "The unique identifier for the caterer."
            },
            {
              "name": "categoryId",
              "description": "The unique identifier for the category."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to ensure security, scalability, and efficient data access. The `MenuItem` entity now has a simple `category` string field, as categories are determined by AI and no longer need to be stored as a separate collection. The rest of the structure remains the same to support user profiles, caterer profile, and order management with appropriate data segregation for security and querying efficiency."
  }
}

    